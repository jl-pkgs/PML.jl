var documenterSearchIndex = {"docs":
[{"location":"generated/Calib_site/#Calibrate-PMLV2-model-using-FLUXNET-data","page":"Calibrate PMLV2 model using FLUXNET data","title":"Calibrate PMLV2 model using FLUXNET data","text":"","category":"section"},{"location":"generated/Calib_site/","page":"Calibrate PMLV2 model using FLUXNET data","title":"Calibrate PMLV2 model using FLUXNET data","text":"US Twt (CRO, 2009)","category":"page"},{"location":"generated/Calib_site/","page":"Calibrate PMLV2 model using FLUXNET data","title":"Calibrate PMLV2 model using FLUXNET data","text":"using PenmanMonteithLeuning, Ipaper\n\ndf_out, df, _par = deserialize(file_FLUXNET_CRO_USTwt)\n\n_par = (α=0.03265625, η=0.069296875, g1=9.552734375,\n  VCmax25=17.671875, VPDmin=1.21515625, VPDmax=3.5, D0=0.6541015625,\n  kQ=0.10114375, kA=0.89921875, S_sls=0.01015625, fER0=0.152734375, hc=0.5)\n\npar = Param_PMLV2(; _par..., hc=0.5)\ndf.GPP_obs = df.GPPobs\ndf.ET_obs = df.ETobs","category":"page"},{"location":"generated/Calib_site/#模型参数率定","page":"Calibrate PMLV2 model using FLUXNET data","title":"模型参数率定","text":"","category":"section"},{"location":"generated/Calib_site/","page":"Calibrate PMLV2 model using FLUXNET data","title":"Calibrate PMLV2 model using FLUXNET data","text":"parNames = [\n  :α, :η, :g1, :VCmax25, :VPDmin, :VPDmax, :D0, :kQ, :kA, :S_sls, :fER0 # :hc\n]\n\ntheta, goal, flag = ModelCalib(df, par0, parNames)\ndf_out = PMLV2_sites(df; par=theta2par(theta, parNames))\ndf_out[1:10, :]","category":"page"},{"location":"generated/Calib_site/#拟合优度","page":"Calibrate PMLV2 model using FLUXNET data","title":"拟合优度","text":"","category":"section"},{"location":"generated/Calib_site/","page":"Calibrate PMLV2 model using FLUXNET data","title":"Calibrate PMLV2 model using FLUXNET data","text":"gof = [\n  (; var=\"ET\", GOF(df.ET_obs, df_out.ET)...),\n  (; var=\"GPP\", GOF(df.GPP_obs, df_out.GPP)...)] |> DataFrame\nDataFrame(gof)","category":"page"},{"location":"generated/Calib_site/#绘图","page":"Calibrate PMLV2 model using FLUXNET data","title":"绘图","text":"","category":"section"},{"location":"generated/Calib_site/","page":"Calibrate PMLV2 model using FLUXNET data","title":"Calibrate PMLV2 model using FLUXNET data","text":"using Plots\ngr(framestyle=:box, titlefontsize=12)\nt = df.date\ninds = 1:46*1\n\nfunction plot_var(var; label=string(var), title=string(var),\n  data=df_out, scale=1, kw...)\n  plot(t[inds], data[inds, var] * scale; label, title, kw...)\nend\nfunction plot_var!(p, var; label=string(var),\n  data=df_out, kw...)\n  plot!(p, t[inds], data[inds, var]; label, kw...)\nend\n\np_et = plot(title=\"ET components (mm/d)\")\nplot_var!(p_et, :Ec)\nplot_var!(p_et, :Es)\nplot_var!(p_et, :Ei)\nplot_var!(p_et, :ETobs; data=df, label=\"ET_obs\", color=:black)\n\np_gpp = plot_var(:GPP; title=\"GPP (gC m-2 d-1)\", label=\"GPP\")\nplot_var!(p_gpp, :GPPobs; data=df, label=\"GPP_obs\", color=:black)\n\nplot(\n  p_et, p_gpp,\n  plot_var(:Eeq; title=\"Eeq (mm/d)\", label=\"Eeq\"),\n  plot_var(:Gc_w; title=\"Conductance (m s-1)\", label=\"Gc\"),\n  plot_var(:fval_soil; title=\"β_soil\", label=\"β_soil\"),\n  plot_var(:VPD; data=df, scale=-1, title=\"-VPD (kPa)\", label=\"-VPD\"),\n  plot_var(:Pi; title=\"P - Ei (mm/d)\"),\n  plot_var(:Es_eq; title=\"Es_eq (mm/d)\"),\n  size=(800, 700),\n  layout=(4, 2),\n)","category":"page"},{"location":"generated/Calib_site/","page":"Calibrate PMLV2 model using FLUXNET data","title":"Calibrate PMLV2 model using FLUXNET data","text":"","category":"page"},{"location":"generated/Calib_site/","page":"Calibrate PMLV2 model using FLUXNET data","title":"Calibrate PMLV2 model using FLUXNET data","text":"This page was generated using Literate.jl.","category":"page"},{"location":"#Reference","page":"Reference","title":"Reference","text":"","category":"section"},{"location":"#PenmanMonteithLeuning.PMLV2","page":"Reference","title":"PenmanMonteithLeuning.PMLV2","text":"PMLV2 (Penman–Monteith–Leuning Version 2) Evapotranspiration model\n\nArguments\n\nPrcp : mm/d\nTavg : degC\nRs   : W m-2\nRn   : W m-2\nVPD  : W m-2\nU2   : m/s\nLAI  : m2 m-2\nPa   : kPa\nCa   : ppm, default 380\nΩ    : clamping index, default is 1.0\n\nExamples\n\n\n\nReferences\n\nGan Rong, 2018, Ecohydrology\nZhang Yongqiang, 2019, RSE\nKong Dongdong, 2019, ISPRS\n\n\n\n\n\nPMLV2(Prcp, Tavg, Rs, Rn, VPD, U2, LAI, Pa, Ca; par=param0, frame=3)\n\nNotes\n\n一个站点的计算。注意，不同植被类型，参数不同。\n\nArguments\n\nframe: in 8-days\n\n\n\n\n\nArguments\n\nkw: named keyword arguments\nr: interm_PML\n\n\n\n\n\n","category":"function"},{"location":"#PenmanMonteithLeuning.cal_Ei_Dijk2021","page":"Reference","title":"PenmanMonteithLeuning.cal_Ei_Dijk2021","text":"cal_Ei_Dijk2021(Prcp::T, LAI::T, par::Param_PMLV2) where {T<:Real}\n\nReferences\n\nvan Dijk, A.I.J.M, 2001, Eq2.\n\n\n\n\n\n","category":"function"},{"location":"#PenmanMonteithLeuning.photosynthesis","page":"Reference","title":"PenmanMonteithLeuning.photosynthesis","text":"photosynthesis(Tavg::T, Rs::T, VPD::T, LAI::T, Ca=380.0; par)\n\nExample\n\n# GPP, Gc_w = photosynthesis(Tavg, Rs, VPD, LAI, Ca; par)\n\n\n\n\n\n","category":"function"},{"location":"#PenmanMonteithLeuning.aerodynamic_conductance","page":"Reference","title":"PenmanMonteithLeuning.aerodynamic_conductance","text":"aerodynamic_conductance(U2, hc)\n\nArguments\n\nU2: wind speed at 2m\nhc: canopy height\n\nReturn\n\nGa: aerodynamic conductance in m/s\n\n\n\n\n\n","category":"function"},{"location":"#PenmanMonteithLeuning.ModelCalib","page":"Reference","title":"PenmanMonteithLeuning.ModelCalib","text":"ModelCalib(df::AbstractDataFrame, par0::AbstractETParam; \n    IGBPcode=nothing, maxn=2500, of_gof=:NSE, kw...)\n\n\n\n\n\n","category":"function"},{"location":"#PenmanMonteithLeuning.Param_PMLV2","page":"Reference","title":"PenmanMonteithLeuning.Param_PMLV2","text":"struct Param_PMLV2{FT<:AbstractFloat} <: AbstractETParam{FT}\n\nFields\n\nα::Real: initial slope of the light response curve to assimilation rate, (i.e., quantum efficiency; μmol CO2 [μmol PAR]⁻¹)` Default: 0.06\nη::Real: initial slope of the CO2 response curve to assimilation rate, (i.e., carboxylation efficiency; μmol m⁻² s⁻¹ [μmol m⁻² s⁻¹]⁻¹) Default: 0.04\ng1::Real: stomatal conductance coefficient, μmol m⁻² s⁻¹ Default: 10.0\nVCmax25::Real: carbon saturated rate of photosynthesis at 25 °C, μmol m⁻² s⁻¹ Default: 50.0\nVPDmin::Real: parameter to constrain gc, kPa Default: 0.9\nVPDmax::Real: parameter to constrain gc, kPa Default: 4.0\nD0::Real: 水汽压参数 Default: 0.7\nkQ::Real: extinction coefficients for visible radiation Default: 0.45\nkA::Real: extinction coefficients for available energy Default: 0.7\nS_sls::Real: Specific leaf storage, van Dijk, A.I.J.M, 2001, Eq2 Default: 0.1\nfER0::Real: Canopy cover fraction related parameter Default: 0.1\nhc::Real: canopy height, [m] Default: 1.0\nd_pc::Real: photoperiod constraint Default: 2.0\n_hc::Vector{FT} where FT<:Real: Default: [1.0, 1.0, 1.0]\n_η::Vector{FT} where FT<:Real: Default: [0.04, 0.04, 0.04]\n_α::Vector{FT} where FT<:Real: Default: [0.06, 0.06, 0.06]\n_g1::Vector{FT} where FT<:Real: Default: [10.0, 10.0, 10.0]\n_VCmax25::Vector{FT} where FT<:Real: Default: [50.0, 50.0, 50.0]\n\n\n\n\n\n","category":"type"}]
}
