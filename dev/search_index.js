var documenterSearchIndex = {"docs":
[{"location":"#Reference","page":"Reference","title":"Reference","text":"","category":"section"},{"location":"","page":"Reference","title":"Reference","text":"PMLV2\n\ncal_Ei_Dijk2021\nphotosynthesis\naerodynamic_conductance\n\nmodel_calib\nParam_PMLV2","category":"page"},{"location":"#PML.PMLV2","page":"Reference","title":"PML.PMLV2","text":"PMLV2 (Penman–Monteith–Leuning Version 2) Evapotranspiration model\n\nArguments\n\nPrcp : mm/d\nTavg : degC\nRs   : W m-2\nRn   : W m-2\nVPD  : W m-2\nU2   : m/s\nLAI  : m2 m-2\nPa   : kPa\nCa   : ppm, default 380\nΩ    : clamping index, default is 1.0\n\nExamples\n\n\n\nReferences\n\nGan Rong, 2018, Ecohydrology\nZhang Yongqiang, 2019, RSE\nKong Dongdong, 2019, ISPRS\n\n\n\n\n\nPMLV2(Prcp, Tavg, Rs, Rn, VPD, U2, LAI, Pa, Ca; par=param0, frame=3)\n\nNotes\n\n一个站点的计算。注意，不同植被类型，参数不同。\n\nArguments\n\nframe: in 8-days\n\n\n\n\n\nArguments\n\nkw: named keyword arguments\nr: interm_PML\n\n\n\n\n\n","category":"function"},{"location":"#PML.cal_Ei_Dijk2021","page":"Reference","title":"PML.cal_Ei_Dijk2021","text":"cal_Ei_Dijk2021(Prcp::T, LAI::T, par::Param_PMLV2) where {T<:Real}\n\nReferences\n\nvan Dijk, A.I.J.M, 2001, Eq2.\n\n\n\n\n\n","category":"function"},{"location":"#PML.photosynthesis","page":"Reference","title":"PML.photosynthesis","text":"photosynthesis(Tavg::T, Rs::T, VPD::T, LAI::T, Ca=380.0; par)\n\nExample\n\n# GPP, Gc_w = photosynthesis(Tavg, Rs, VPD, LAI, Ca; par)\n\n\n\n\n\n","category":"function"},{"location":"#PML.aerodynamic_conductance","page":"Reference","title":"PML.aerodynamic_conductance","text":"aerodynamic_conductance(U2, hc)\n\nArguments\n\nU2: wind speed at 2m\nhc: canopy height\n\nReturn\n\nGa: aerodynamic conductance in m/s\n\n\n\n\n\n","category":"function"},{"location":"#PML.model_calib","page":"Reference","title":"PML.model_calib","text":"model_calib(df::AbstractDataFrame, par0::AbstractETParam; \n    IGBPcode=nothing, maxn=2500, of_gof=:NSE, kw...)\n\n\n\n\n\n","category":"function"},{"location":"#PML.Param_PMLV2","page":"Reference","title":"PML.Param_PMLV2","text":"struct Param_PMLV2{FT<:AbstractFloat} <: AbstractETParam{FT}\n\nFields\n\nAlpha::AbstractFloat: initial slope of the light response curve to assimilation rate, (i.e., quantum efficiency; μmol CO2 [μmol PAR]⁻¹)` Default: 0.06\nThelta::AbstractFloat: initial slope of the CO2 response curve to assimilation rate, (i.e., carboxylation efficiency; μmol m⁻² s⁻¹ [μmol m⁻² s⁻¹]⁻¹) Default: 0.04\nm::AbstractFloat: stomatal conductance coefficient Default: 10.0\nAm_25::AbstractFloat: carbon saturated rate of photosynthesis at 25 °C, μmol m⁻² s⁻¹ Default: 50.0\nVPDmin::AbstractFloat: parameter to constrain gc, kPa Default: 0.9\nVPDmax::AbstractFloat: parameter to constrain gc, kPa Default: 4.0\nD0::AbstractFloat:  Default: 0.7\nkQ::AbstractFloat: extinction coefficients for visible radiation Default: 0.45\nkA::AbstractFloat: extinction coefficients for available energy Default: 0.7\nS_sls::AbstractFloat: Specific leaf storage, van Dijk, A.I.J.M, 2001, Eq2 Default: 0.1\nfER0::AbstractFloat: Canopy cover fraction related parameter Default: 0.1\nhc::AbstractFloat: canopy height, [m] Default: 1.0\n\n\n\n\n\n","category":"type"},{"location":"generated/calib_IGBP/","page":"Example","title":"Example","text":"EditURL = \"../../../examples/calib_IGBP.jl\"","category":"page"},{"location":"generated/calib_IGBP/#Example","page":"Example","title":"Example","text":"","category":"section"},{"location":"generated/calib_IGBP/","page":"Example","title":"Example","text":"using PML, Ipaper\n\ndf_out, df, par = deserialize(file_FLUXNET_CRO)\ndf.GPP_obs = df.GPPobs\ndf.ET_obs = df.ETobs","category":"page"},{"location":"generated/calib_IGBP/#模型参数率定","page":"Example","title":"模型参数率定","text":"","category":"section"},{"location":"generated/calib_IGBP/","page":"Example","title":"Example","text":"theta, goal, flag = model_calib(df, par0)\ndf_out = PMLV2_sites(df; par=theta2par(theta))\ndf_out[1:10, :]","category":"page"},{"location":"generated/calib_IGBP/#拟合优度","page":"Example","title":"拟合优度","text":"","category":"section"},{"location":"generated/calib_IGBP/","page":"Example","title":"Example","text":"gof = [\n  (; var=\"ET\", GOF(df.ET_obs, df_out.ET)...),\n  (; var=\"GPP\", GOF(df.GPP_obs, df_out.GPP)...)] |> DataFrame\nDataFrame(gof)","category":"page"},{"location":"generated/calib_IGBP/#绘图","page":"Example","title":"绘图","text":"","category":"section"},{"location":"generated/calib_IGBP/","page":"Example","title":"Example","text":"using Plots\ngr(framestyle=:box)\nt = df.date","category":"page"},{"location":"generated/calib_IGBP/","page":"Example","title":"Example","text":"inds = 1:length(t)","category":"page"},{"location":"generated/calib_IGBP/","page":"Example","title":"Example","text":"inds = 1:46\n\nfunction plot_var(var; label=string(var), title=string(var), kw...)\n  plot(t[inds], df_out[inds, var]; label, title, kw...)\nend\nfunction plot_var!(p, var; label=string(var), kw...)\n  plot!(p, t[inds], df_out[inds, var]; label, kw...)\nend\n\np1 = plot(title=\"ET components (mm/d)\")\nplot_var!(p1, :Ec)\nplot_var!(p1, :Es)\nplot_var!(p1, :Ei)\n\nplot(\n  p1,\n  plot_var(:GPP; title=\"GPP (gC m-2 d-1)\", label=\"GPP\"),\n  plot_var(:Gc_w; title=\"Conductance (m s-1)\", label=\"Gc\"),\n  plot_var(:fval_soil; title=\"β_soil\", label=\"β_soil\"),\n  plot_var(:Pi; title=\"P - Ei (mm/d)\"),\n  plot_var(:Es_eq; title=\"Es_eq (mm/d)\"),\n  size=(800, 700),\n  layout=(3, 2)\n)","category":"page"},{"location":"generated/calib_IGBP/","page":"Example","title":"Example","text":"","category":"page"},{"location":"generated/calib_IGBP/","page":"Example","title":"Example","text":"This page was generated using Literate.jl.","category":"page"}]
}
